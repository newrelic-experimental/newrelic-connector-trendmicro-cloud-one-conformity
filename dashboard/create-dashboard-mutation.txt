mutation {
  dashboardCreate(accountId: <NEW_RELIC_ACCOUNT_ID>, dashboard: {name: "TrendMicroCloudOneConformity", pages: [{name: "TrendMicroCloudOneConformity", widgets: [{configuration: {bar: null, billboard: {nrqlQueries: [{accountId: <NEW_RELIC_ACCOUNT_ID>, query: "SELECT uniqueCount(id, ruleId) as Total, filter(uniqueCount(id, ruleId), WHERE status = 'SUCCESS') as Succeeded, filter(uniqueCount(id, ruleId), WHERE status = 'FAILURE') as Failed, round(percentage(uniqueCount(id, ruleId), WHERE status = 'SUCCESS')) as '% Compliant' from TMCloudOneConformityEvent SINCE 1 week ago LIMIT MAX "}], thresholds: [{alertSeverity: WARNING, value: 80}, {alertSeverity: CRITICAL, value: 50}]}, line: null, pie: null, table: null}, title: "Summary", visualization: {id: "viz.billboard"}}, {configuration: {bar: null, billboard: {nrqlQueries: [{accountId: <NEW_RELIC_ACCOUNT_ID>, query: "SELECT round(filter(uniqueCount(id, ruleId) * 100, WHERE status = 'SUCCESS' AND categories LIKE '%security%')/ filter(uniqueCount(id, ruleId), WHERE categories LIKE '%security%')) as Security, round(filter(uniqueCount(id, ruleId) * 100, WHERE status = 'SUCCESS' AND categories LIKE '%reliability%')/ filter(uniqueCount(id, ruleId), WHERE categories LIKE '%reliability%')) as Reliability, round(filter(uniqueCount(id, ruleId) * 100, WHERE status = 'SUCCESS' AND categories LIKE '%operational-excellence%')/ filter(uniqueCount(id, ruleId), WHERE categories LIKE '%operational-excellence%')) as 'Operational Excellence', round(filter(uniqueCount(id, ruleId) * 100, WHERE status = 'SUCCESS' AND categories LIKE '%performance-efficiency%')/ filter(uniqueCount(id, ruleId), WHERE categories LIKE '%performance-efficiency%')) as 'Performance Efficiency', round(filter(uniqueCount(id, ruleId) * 100, WHERE status = 'SUCCESS' AND categories LIKE '%cost-optimisation%')/ filter(uniqueCount(id, ruleId), WHERE categories LIKE '%cost-optimisation%')) as 'Cost Optimisation' from TMCloudOneConformityEvent  since 1 week ago limit max"}], thresholds: [{alertSeverity: CRITICAL, value: 50}, {alertSeverity: WARNING, value: 80}]}, line: null, pie: null, table: null}, title: "Compliance % by Category", visualization: {id: "viz.billboard"}}, {configuration: {bar: null, billboard: null, line: null, pie: {nrqlQueries: [{accountId: <NEW_RELIC_ACCOUNT_ID>, query: "SELECT uniqueCount(id, ruleId) as 'Failed Check' FROM TMCloudOneConformityEvent WHERE status = 'FAILURE' FACET riskLevel SINCE 1 WEEK ago LIMIT MAX "}]}, table: null}, title: "Failed Checks by Risk Level", visualization: {id: "viz.pie"}}, {configuration: {bar: null, billboard: {nrqlQueries: [{accountId: <NEW_RELIC_ACCOUNT_ID>, query: "SELECT uniqueCount(eventId) as Events from TMCloudOneConformityEvent where eventId is NOT NULL SINCE 1 week ago"}], thresholds: [{alertSeverity: CRITICAL, value: 1}]}, line: null, pie: null, table: null}, title: "Real Time Events", visualization: {id: "viz.billboard"}}, {configuration: {bar: null, billboard: null, line: null, pie: null, table: {nrqlQueries: [{accountId: <NEW_RELIC_ACCOUNT_ID>, query: "SELECT ruleId, riskLevel, message, resourceName, resource from TMCloudOneConformityEvent where status = 'FAILURE' AND eventId is NOT NULL SINCE 1 week ago LIMIT MAX "}]}}, title: "Real Time Threat Monitoring", visualization: {id: "viz.table"}}, {configuration: {bar: null, billboard: null, line: {nrqlQueries: [{accountId: <NEW_RELIC_ACCOUNT_ID>, query: "SELECT uniqueCount(id, ruleId) FROM TMCloudOneConformityEvent where status = 'FAILURE' FACET riskLevel TIMESERIES 1 hour since 1 day ago LIMIT MAX "}]}, pie: null, table: null}, title: "Hourly Failed Checks by Risk Level", visualization: {id: "viz.line"}}, {configuration: {bar: null, billboard: null, line: null, pie: {nrqlQueries: [{accountId: <NEW_RELIC_ACCOUNT_ID>, query: "SELECT uniqueCount(id, ruleId) as 'Failed Check' from TMCCEvent WHERE status = 'FAILURE' FACET region since 1 week ago limit max"}]}, table: null}, title: "Failed Checks by Region", visualization: {id: "viz.pie"}}, {configuration: {bar: null, billboard: null, line: null, pie: {nrqlQueries: [{accountId: <NEW_RELIC_ACCOUNT_ID>, query: "SELECT uniqueCount(id, ruleId) as 'Failed Check' FROM TMCloudOneConformityEvent WHERE status = 'FAILURE' FACET service SINCE 1 week ago LIMIT MAX "}]}, table: null}, title: "Failed Checks by Service", visualization: {id: "viz.pie"}}, {configuration: {bar: null, billboard: {nrqlQueries: [{accountId: <NEW_RELIC_ACCOUNT_ID>, query: "SELECT filter(uniqueCount(id, ruleId), WHERE categories LIKE '%security%') as Security , filter(uniqueCount(id, ruleId), WHERE categories LIKE '%reliability%') as Reliability, filter(uniqueCount(id, ruleId), WHERE categories LIKE '%operational-excellence%') as 'Operational Excellence', filter(uniqueCount(id, ruleId), WHERE categories LIKE '%performance-efficiency%') as 'Performance Efficiency', filter(uniqueCount(id, ruleId), WHERE categories LIKE '%cost-optimisation%') as 'Cost Optimisation' FROM TMCloudOneConformityEvent WHERE status = 'FAILURE' SINCE 1 WEEK ago LIMIT MAX"}], thresholds: null}, line: null, pie: null, table: null}, title: "Failed Checks by Category", visualization: {id: "viz.billboard"}}, {configuration: {bar: null, billboard: null, line: null, pie: null, table: {nrqlQueries: [{accountId: <NEW_RELIC_ACCOUNT_ID>, query: "SELECT uniqueCount(id, ruleId) as 'Failures' FROM  TMCloudOneConformityEvent where status = 'FAILURE' FACET ruleId, ruleTitle, service, riskLevel SINCE 1 week ago LIMIT MAX "}]}}, title: "Failed Checks by Rule", visualization: {id: "viz.table"}}, {configuration: {bar: null, billboard: null, line: null, pie: null, table: {nrqlQueries: [{accountId: <NEW_RELIC_ACCOUNT_ID>, query: "SELECT uniqueCount(ruleId, Id) as 'Failures' FROM  TMCloudOneConformityEvent where service IS NOT NULL facet resourceName, service, region where status = 'FAILURE' SINCE 1 week ago LIMIT MAX "}]}}, title: "Failed Checks by Resource", visualization: {id: "viz.table"}}]}], permissions: PUBLIC_READ_ONLY}) {
    entityResult {
      name
      guid
      updatedAt
      createdAt
    }
    errors {
      description
      type
    }
  }
}
